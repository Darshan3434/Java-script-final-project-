<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shop Billing System</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    body {
      background: #f2f2f2;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: 320px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      cursor: pointer;
      border: none;
      border-radius: 6px;
      color: white;
      background: #4CAF50;
      transition: 0.2s;
    }
    button:hover {
      background: #45a049;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #4CAF50;
      color: white;
    }
    #billTable th {
      background: #333;
    }
    .total {
      text-align: right;
      font-weight: bold;
      margin-top: 10px;
    }
    .print-btn {
      background: #007bff;
    }
  </style>
</head>
<body>
  <h1>ðŸ§¾ Shop Billing System</h1>

  <div class="container">
    <!-- Add product form -->
    <div class="card">
      <h3>Add Product</h3>
      <input type="text" id="productName" placeholder="Enter product name">
      <input type="number" id="productPrice" placeholder="Enter price">
      <button onclick="addProduct()">Add Product</button>

      <h3>Product List</h3>
      <table id="productTable">
        <thead>
          <tr><th>Name</th><th>Price</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Bill preview -->
    <div class="card">
      <h3>Bill Preview</h3>
      <table id="billTable">
        <thead>
          <tr><th>Product</th><th>Price</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <p class="total">Total: â‚¹<span id="total">0</span></p>
      <button class="print-btn" onclick="downloadPDF()">Download PDF</button>
    </div>
  </div>

  <script>
    let products = [];
let bill = [];

function addProduct() {
  const name = document.getElementById('productName').value.trim();
  const price = parseFloat(document.getElementById('productPrice').value);
  if (!name || isNaN(price)) return alert('Please enter valid name and price');

  products.push({ name, price });
  document.getElementById('productName').value = '';
  document.getElementById('productPrice').value = '';
  renderProducts();
}

function renderProducts() {
  const tbody = document.querySelector('#productTable tbody');
  tbody.innerHTML = '';
  products.forEach((p, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${p.name}</td><td>Rs. ${p.price.toFixed(2)}</td>`;
    tr.style.cursor = 'pointer';
    tr.onclick = () => addToBill(i);
    tbody.appendChild(tr);
  });
}

function addToBill(index) {
  bill.push(products[index]);
  renderBill();
}

function renderBill() {
  const tbody = document.querySelector('#billTable tbody');
  tbody.innerHTML = '';
  let total = 0;
  bill.forEach(item => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${item.name}</td><td>Rs. ${item.price.toFixed(2)}</td>`;
    tbody.appendChild(tr);
    total += item.price;
  });
  document.getElementById('total').textContent = total.toFixed(2);
}

async function downloadPDF() {
  if (bill.length === 0) return alert("Please add products to bill first!");
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFont("helvetica", "bold");
  doc.setFontSize(22);
  doc.setTextColor(20, 20, 20);
  doc.text("SMART SHOP", 105, 20, null, null, "center");

  doc.setFont("helvetica", "normal");
  doc.setFontSize(11);
  doc.setTextColor(90);
  doc.text("123 Market Road, City Center, India", 105, 27, null, null, "center");
  doc.text("Phone: +91 98765 43210 | Email: smartshop@email.com", 105, 32, null, null, "center");

  // Date & Cashier (right/left alignment)
  const date = new Date();
  doc.setFontSize(11);
  doc.setTextColor(60);
  doc.text("Date: " + date.toLocaleString(), 20, 40);
  doc.text("Cashier: Admin", 150, 40);

  // --- Table Header ---
  const startY = 50;
  const startX = 20;
  const colWidths = [120, 40];
  const rowHeight = 10;

  doc.setDrawColor(60);
  doc.setFillColor(0, 123, 255);
  doc.setTextColor(255, 255, 255);
  doc.rect(startX, startY, colWidths[0], rowHeight, 'FD');
  doc.rect(startX + colWidths[0], startY, colWidths[1], rowHeight, 'FD');
  doc.text("Product", startX + 5, startY + 7);
  doc.text("Price (Rs.)", startX + colWidths[0] + 5, startY + 7);

  // --- Table Rows ---
  doc.setTextColor(0);
  let y = startY + rowHeight;
  let total = 0;
  bill.forEach((item) => {
    doc.rect(startX, y, colWidths[0], rowHeight);
    doc.rect(startX + colWidths[0], y, colWidths[1], rowHeight);
    doc.text(item.name, startX + 5, y + 7);
    doc.text(item.price.toFixed(2).toString(), startX + colWidths[0] + 5, y + 7);
    total += item.price;
    y += rowHeight;
  });

  // --- Total Section ---
  y += 5;
  doc.setFont("helvetica", "bold");
  doc.setFontSize(13);
  doc.text("Total Amount: Rs. " + total.toFixed(2), 120, y);

  // --- Footer ---
  y += 20;
  doc.setFont("helvetica", "normal");
  doc.setFontSize(12);
  doc.text("Thank you for shopping with us!", 105, y, null, null, "center");
  y += 6;
  doc.text("Please visit again.", 105, y, null, null, "center");

  // --- Border Box ---
  doc.setDrawColor(180);
  doc.rect(15, 10, 180, y - 5);

  // Save File
  doc.save("Shop_Bill.pdf");
}

  </script>
</body>
</html>
